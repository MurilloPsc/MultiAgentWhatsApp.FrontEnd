<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Atendimento - Agente</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h3>Atendimento</h3>
        <button class="btn btn-outline-danger btn-sm" onclick="logout()">Sair</button>
    </div>

    <div class="alert alert-info" id="status">
        <strong>Status:</strong> Carregando...
    </div>

<div id="indicadorMensagens"
     class="alert alert-warning d-none mt-2">
</div>


    <div class="card">
        <div class="card-header">
            Conversa Atual
        </div>

        <!-- CHAT -->
        <div class="card-body" id="chat" style="height:300px; overflow-y:auto;">
            <div class="text-muted">Nenhuma mensagem ainda.</div>
        </div>

        <div class="card-footer d-flex">
            <input id="mensagem" class="form-control me-2" placeholder="Digite sua mensagem...">
            <button class="btn btn-primary" onclick="enviarMensagem()">Enviar</button>
        </div>
    </div>

    <button id="btnFinalizar" class="btn btn-danger mt-3 d-none">
        Finalizar atendimento
    </button>
</div>

<!-- ðŸ” SeguranÃ§a -->
<script src="/js/auth.js"></script>

<script>
/* ==========================
   CONFIGURAÃ‡Ã•ES
========================== */
requireRole("AGENTE");

const API = "https://api.all-multiagente.com.br";
const token = localStorage.getItem("token");

let atendimentoAtualId = null;
let numeroClienteAtual = null;

let ultimaMensagemId = 0;
let mensagensNaoLidas = 0;



/* ==========================
   
